<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, maximum-scale=1, minimum-scale=1" />
    <title>Inventions timeline</title>
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="http://d3js.org/topojson.v1.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700%7CRoboto%7CJosefin+Sans:100,300,400,500" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="style.css">

</head>

<body>
    <div class="container-fluid text-center img-responsive" id="custom_header">
        <div class="jumbotron">
                <h1>World inventions timeline visualization</h1>
                <p>View 200 years of inventions from all over the world!</p>
                <a href="#viz" class="btn btn-lg my-button" id="view">View</a>
        </div>
    </div>

     <div id="info" class="hidden"></div>

    <script src="https://unpkg.com/scrollreveal/dist/scrollreveal.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="inventions.js"></script>
    <script src="https://d3js.org/d3-timer.v1.min.js"></script>

</body>
<script type="text/javascript">
$( document ).ready(function() {
var h = 800
    w = 1600;
var y=0, y1=0;
var x=0, x1=0;
var x3=0,y3=830;
var leftPadding = 10;
var rightPadding=40;


var section = d3.select("body")
            .append("section").attr("id","viz");

var svg = d3.select("#viz").append("svg")
            .attr("class","visualization")
            .attr("width",w)
            .attr("height",h);

var scale = d3.scale.linear();

scale.domain([1800,d3.max(inventions,function(d) {return d.YEAR;})])
     .range([leftPadding,w-rightPadding]);


var formatYear = d3.format("")

var timelineAxis = d3.svg.axis()
                    .scale(scale)
                    .ticks(200)
                    .tickFormat(function(d,i){
                    if((i+1800)%5==0) {
                        return formatYear(i+1800);
                    }
                    else return '';
                    },formatYear)
                    .orient("top");
d3.selectAll(".line")
        .attr("y2",function(d,i){
            if ((i+1800)%5==0){
                return 6;
            }
            else return 2;
        });
svg.append("g")
           .call(timelineAxis)
           .attr("transform","translate("+5+","+18+")")
           .attr("class","timelineAxis");

d3.select("path.domain")
    .style("stroke","white")
d3.selectAll("g.timelineAxis g.tick line")
    .attr("y2",function(d,i){
        if(i%5==0) return -5
        else return -3
    })

var loaded=false;
d3.timerFlush();
var t = d3.timer(function(elapsed) {
        if (elapsed >= 1) {
            t.stop();
            loaded=true;
        }
    },88000);

var clicked=null;
var clickedName=null;
var color = d3.scale.linear().domain([1,50])
      .interpolate(d3.interpolateHcl)
      .range([d3.rgb("#1582EE"), d3.rgb('#1715EE')]);

var delayAdd=500;
var delayAdd1=500;
var delayAdd2=500;
var delayAdd3=500;
var delayAdd4=500;
var delayAdd5=500;

var info=0;

var projection = d3.geo.mercator()
    .scale(1)
    .translate([0,-0.25]);
var path = d3.geo.path()
    .projection(projection);
// set-up svg canvas
var map = svg.append("g")
    .attr("class","map");


//https://github.com/johan/world.geo.json
d3.json("world_map.json", function(error, data) {
    d3.csv("countries_id.csv", function(error, csv) {
        var world = data.features;
        csv.forEach(function(d, i) {
            world.forEach(function(e, j) {
                if (d.id ==  e.id){
                    e.name = d.name
                }
            })
        })
        // calculate bounds, scale and transform 
        // see http://stackoverflow.com/questions/14492284/center-a-map-in-d3-given-a-geojson-object
        var b = path.bounds(data),
            s = .95 / Math.max((b[1][0] - b[0][0]) / w, (b[1][1] - b[0][1]) / (h-130)),
            t = [(w - s * (b[1][0] + b[0][0])) / 2, ((h-130) - s * (b[1][1] + b[0][1])) / 2];
        projection.scale(s)
            .translate(t);
        map.selectAll("path")
            .data(world).enter()
            .append("path")
            .attr("d", path)
            .attr("class","map_path")
            .attr("id",function(d,i){
                return d.id;
            })
            .on("mouseover", function(d, i) {
                if(loaded){
                    d3.select(this).transition().style("fill","#EB9A28");
                    var count = d3.selectAll("line#"+d.id).size();
                    d3.select("#info").classed("hidden",false)
                                    .html(d.properties.name+"<br>Inventions:"+count);
                }
            })
            .on("mouseleave", function(d,i){
                if(loaded){
                    if(clicked==d.id){
                     d3.select("#info").classed("hidden",true);
                    }else{
                        d3.select(this).transition()
                            .style("fill", function(f,i){
                                var count = d3.selectAll("line#"+f.id).size();
                                if(count>=50){
                                    return color(50);
                                }else if(count==0){
                                    return "#15A5EE";
                                }
                                return color(count);
                            });
                             d3.select("#info").classed("hidden",true);
                    }
                }
            })
            .on("mousemove",function(d,i){
                if(loaded){
      	        var xPosition = parseFloat(d3.event.pageX) + 15 ;
				var yPosition = parseFloat(d3.event.pageY) - 15 ;
				d3.select("#info")
					.style("left", xPosition + "px")
					.style("top", yPosition + "px");
					
				d3.select("#info").classed("hidden",false);
                }
            })
            .on("click",function(d,i){
                if(loaded){
                    if(clicked==d.id){
                        d3.selectAll("line#"+d.id)
                        .style("visibility","hidden");
                        d3.select(this).transition()
                            .style("fill", function(f,i){
                                var count = d3.selectAll("line#"+f.id).size();
                                 if(count>=50){
                                    return color(50);
                                }else if(count==0){
                                    return "#15A5EE";
                                }
                                return color(count);
                            });
                        d3.selectAll(".on").attr("href","lightbulb_off2.png")
                        .attr("class","off");
                        clicked=null;
                        clickedName=null;
                    }
                    else{
                        d3.selectAll("line#"+clicked)
                        .style("visibility","hidden");
                        d3.selectAll(".map_path").each(function(a,b){
                            d3.select(this).style("fill", function(){
                                var count = d3.selectAll("line#"+a.id).size();
                                 if(count>=50){
                                    return color(50);
                                }else if(count==0){
                                    return "#15A5EE";
                                }
                                return color(count);
                            });
                        })
                        clicked=d.id;
                        clickedName=d.properties.name;
                        d3.selectAll("line#"+d.id)
                        .style("visibility","visible");
                        d3.select(this).transition().style('fill','#EB9A28');
                        showInventions(d);  
                    }
                }
            });

            var arcs = svg.selectAll(".arcs")
                        .data(inventions)
                        .enter()
                        .append("g")
                        .attr("class","arcs")
                        .each(function(f,k){
                            d3.select("path#"+f.id)
                                .transition()
                                .duration(function(){
                                    if(f.INVENTION=="battery"){
                                        return 3000;
                                    }else if(f.INVENTION=="Programmable mechanical computer"){
                                        return 3000;
                                    }else if(f.INVENTION=="electric motor"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="engine with internal combustion"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="telephone"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="light bulb"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="motorcycle"){
                                        return 3000;
                                    }else if(f.INVENTION=="automobile"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="X-ray imaging"){
                                        return 3000;
                                    }else if(f.INVENTION=="engine-powered airplane"){
                                        return 3000;
                                    }else if(f.INVENTION=="rocket engine"){
                                        return 3000;
                                    }else if(f.INVENTION=="television"){
                                        return 3000;
                                    }else if(f.INVENTION=="helicopter"){
                                        return 3000;
                                    }else if(f.INVENTION=="nuclear reactor"){
                                        return 3000;
                                    }else if(f.INVENTION=="atomic bomb"){
                                        return 3000;
                                    }else if(f.INVENTION=="transistor"){
                                        return 3000;
                                    }else if(f.INVENTION=="hard disk drive"){
                                        return 3000;
                                    }else if(f.INVENTION=="personal computer (IBM 610)"){
                                        return 3000;
                                    }else if(f.INVENTION=="Internet"){
                                        return 3000;
                                    }else if(f.INVENTION=="C (programming language)"){
                                        return 3000;
                                    }else if(f.INVENTION=="USB flash drive"){
                                        return 3000;
                                    }else{
                                        return 50;
                                    }
                                })
                                .delay(function(){
                                    if(f.INVENTION=="steamboat"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="Braille system"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="revolver"){
                                         return delayAdd+=3000;
                                    }
                                    else if(f.INVENTION=="oil well"){
                                        return delayAdd+=3000;
                                    }
                                    else if(f.INVENTION=="phonograph"){
                                        return delayAdd+=3000;
                                    }
                                    else if(f.INVENTION=="saccharin"){
                                         return delayAdd+=3000;
                                    }
                                    else if(f.INVENTION=="dishwasher"){
                                       return delayAdd+=3000;
                                    }else if(f.INVENTION=="jukebox"){
                                       return delayAdd+=3000;
                                    }
                                    else if(f.INVENTION=="radio"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="electrocardiogram (ECG, EKG)"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="baby food (prepared)"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="audiotape"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="lawn mower (gasoline-powered)"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="scuba gear"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="microwave oven"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="holography"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="Play-Doh"){
                                        return delayAdd+=3000;
                                    }else if(f.INVENTION=="electric desktop calculator (Model 14-A)"){
                                         return delayAdd+=3000;
                                    }else if(f.INVENTION=="videocassette recorder"){
                                       return delayAdd+=3000;
                                    }else if(f.INVENTION=="static induction thyristor"){
                                         return delayAdd+=3000;
                                    }else{
                                        return delayAdd+=50;
                                    }
                                })
                                .ease("linear")
                                .style("fill", function(d,i){
                                    var count = d3.selectAll("line#"+d.id).size();
                                     if(count>=50){
                                    return color(50);
                                }else if(count==0){
                                    return "#15A5EE";
                                }
                                    return color(count);
                                });


                                d3.select(this)
                                .each(function(){
                                    d3.select("body").append("div").attr("class","priorityInfo text-center")
                                    .style("visibility","hidden")
                                    .style("left", function(){
                                            var item = d3.select("path#"+f.id)
                                            var centroid = path.centroid(item.datum());
                                            if(f.id=="USA"){
                                                        return centroid[0]+"px";
                                                    }
                                            return centroid[0]+"px";
                                            })
                                        .style("top", function(){
                                            var item = d3.select("path#"+f.id);
                                            var centroid = path.centroid(item.datum());
                                            if(f.id=="USA"){
                                                        return centroid[1]+880+"px";
                                                    }
                                            return centroid[1]+850+"px";
                                        })
                                        .html(function(){
                                            if(f.INVENTION=="battery" ||f.INVENTION=="Programmable mechanical computer"||f.INVENTION=="electric motor"||
                                    f.INVENTION=="engine with internal combustion"||f.INVENTION=="telephone"||f.INVENTION=="light bulb"||
                                    f.INVENTION=="motorcycle"||f.INVENTION=="automobile"||f.INVENTION=="X-ray imaging"||f.INVENTION=="engine-powered airplane"||
                                    f.INVENTION=="rocket engine"||f.INVENTION=="television"||f.INVENTION=="helicopter"||f.INVENTION=="nuclear reactor"||
                                    f.INVENTION=="atomic bomb"||f.INVENTION=="transistor"||f.INVENTION=="hard disk drive"||f.INVENTION=="personal computer (IBM 610)"||f.INVENTION=="USB flash drive"){
                                            return "<img src='"+f.INVENTION+".jpg'><br>In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY;
                                    }else return "In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY;
                                        })
                                        .transition()
                                        .duration(function(){
                                            if(f.INVENTION=="battery"){
                                                return 3000;
                                            }else if(f.INVENTION=="Programmable mechanical computer"){
                                                return 3000;
                                            }else if(f.INVENTION=="electric motor"){
                                                return 3000;
                                            }
                                            else if(f.INVENTION=="engine with internal combustion"){
                                                return 3000;
                                            }
                                            else if(f.INVENTION=="telephone"){
                                                return 3000;
                                            }
                                            else if(f.INVENTION=="light bulb"){
                                                return 3000;
                                            }
                                            else if(f.INVENTION=="motorcycle"){
                                                return 3000;
                                            }else if(f.INVENTION=="automobile"){
                                                return 3000;
                                            }
                                            else if(f.INVENTION=="X-ray imaging"){
                                                return 3000;
                                            }else if(f.INVENTION=="engine-powered airplane"){
                                                return 3000;
                                            }else if(f.INVENTION=="rocket engine"){
                                                return 3000;
                                            }else if(f.INVENTION=="television"){
                                                return 3000;
                                            }else if(f.INVENTION=="helicopter"){
                                                return 3000;
                                            }else if(f.INVENTION=="nuclear reactor"){
                                                return 3000;
                                            }else if(f.INVENTION=="atomic bomb"){
                                                return 3000;
                                            }else if(f.INVENTION=="transistor"){
                                                return 3000;
                                            }else if(f.INVENTION=="hard disk drive"){
                                                return 3000;
                                            }else if(f.INVENTION=="personal computer (IBM 610)"){
                                                return 3000;
                                            }else if(f.INVENTION=="Internet"){
                                                return 3000;
                                            }else if(f.INVENTION=="C (programming language)"){
                                                return 3000;
                                            }else if(f.INVENTION=="USB flash drive"){
                                                return 3000;
                                            }else{
                                                return 50;
                                            }
                                        })
                                        .delay(function(){
                                            if(f.INVENTION=="steamboat"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="Braille system"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="revolver"){
                                                return delayAdd4+=3000;
                                            }
                                            else if(f.INVENTION=="oil well"){
                                                return delayAdd4+=3000;
                                            }
                                            else if(f.INVENTION=="phonograph"){
                                                return delayAdd4+=3000;
                                            }
                                            else if(f.INVENTION=="saccharin"){
                                                return delayAdd4+=3000;
                                            }
                                             else if(f.INVENTION=="dishwasher"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="jukebox"){
                                                return delayAdd4+=3000;
                                            }
                                            else if(f.INVENTION=="radio"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="electrocardiogram (ECG, EKG)"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="baby food (prepared)"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="audiotape"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="lawn mower (gasoline-powered)"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="scuba gear"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="microwave oven"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="holography"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="Play-Doh"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="electric desktop calculator (Model 14-A)"){
                                                return delayAdd4+=3000;
                                            }else if(f.INVENTION=="videocassette recorder"){
                                            return delayAdd4+=3000;
                                            }else if(f.INVENTION=="static induction thyristor"){
                                                return delayAdd4+=3000;
                                            }else{
                                                return delayAdd4+=50;
                                            }
                                        })
                                        .ease("linear")
                                        .style("visibility",function(){
                                             if(f.INVENTION=="battery" ||f.INVENTION=="Programmable mechanical computer"||f.INVENTION=="electric motor"||
                                    f.INVENTION=="engine with internal combustion"||f.INVENTION=="telephone"||f.INVENTION=="light bulb"||
                                    f.INVENTION=="motorcycle"||f.INVENTION=="automobile"||f.INVENTION=="X-ray imaging"||f.INVENTION=="engine-powered airplane"||
                                    f.INVENTION=="rocket engine"||f.INVENTION=="television"||f.INVENTION=="helicopter"||f.INVENTION=="nuclear reactor"||
                                    f.INVENTION=="atomic bomb"||f.INVENTION=="transistor"||f.INVENTION=="hard disk drive"||f.INVENTION=="personal computer (IBM 610)"||
                                    f.INVENTION=="Internet"||f.INVENTION=="C (programming language)"||f.INVENTION=="USB flash drive"){
                                        return "visible";
                                            }
                                            else return "hidden";
                                        })
                                        .style("left",function(){
                                            if(f.INVENTION!="USB flash drive")
                                            return scale(f.YEAR)-2+"px";
                                            return scale(f.YEAR)-250+"px";
                                        })
                                        .style("top",function(){
                                            if (x3==0) {
                                                x3++;
                                                return y3+"px";
                                            }
                                            else if(inventions[x3].YEAR!=inventions[x3-1].YEAR){
                                                y3=830;
                                            }
                                            else y3+=17;
                                            x3++;
                                            return y3+"px";})
                                            .transition()
                                            .duration(1000)
                                            .delay(function(){
                                                 if(f.INVENTION=="battery"){
                                                    return delayAdd5+=3500;
                                                }else if(f.INVENTION=="Programmable mechanical computer"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="electric motor"){
                                                    return delayAdd5+=3000;
                                                }
                                                else if(f.INVENTION=="engine with internal combustion"){
                                                    return delayAdd5+=3000;
                                                }
                                                else if(f.INVENTION=="telephone"){
                                                    return delayAdd5+=3000;
                                                }
                                                else if(f.INVENTION=="light bulb"){
                                                    return delayAdd5+=3000;
                                                }
                                                else if(f.INVENTION=="motorcycle"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="automobile"){
                                                    return delayAdd5+=3000;
                                                }
                                                else if(f.INVENTION=="X-ray imaging"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="engine-powered airplane"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="rocket engine"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="television"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="helicopter"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="nuclear reactor"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="atomic bomb"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="transistor"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="hard disk drive"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="personal computer (IBM 610)"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="Internet"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="C (programming language)"){
                                                    return delayAdd5+=3000;
                                                }else if(f.INVENTION=="USB flash drive"){
                                                    return delayAdd5+=3000;
                                                }else{
                                                    return delayAdd5+=70;
                                                }
                                            })
                                            .style("opacity","0")
                                            .transition()
                                            .style("visibility","hidden");

                                });
                                
                            
                            
                            d3.select(this)
                            .append("svg:image")
                            .attr("class","off")
                            .style("visibility","hidden")
                            .attr("id",function(f,k){
                                       return f.id;
                                     })
                            .each(function(){
                                d3.select(this)
                                .attr("href","lightbulb_off2.png")
                                .attr("x", function(){
                                    var item = d3.select("path#"+f.id)
                                    var centroid = path.centroid(item.datum());
                                     if(f.id=="USA"){
                                                  return centroid[0]+30;
                                              }
                                    return centroid[0];
                                    })
                                .attr("y", function(){
                                    var item = d3.select("path#"+f.id);
                                    var centroid = path.centroid(item.datum());
                                     if(f.id=="USA"){
                                                  return centroid[1]+80;
                                              }
                                    return centroid[1]+50;
                                    })
                                .attr("width",15)
                                .attr("height",15)
                                .transition()
                                .duration(function(){
                                    if(f.INVENTION=="battery"){
                                        return 3000;
                                    }else if(f.INVENTION=="Programmable mechanical computer"){
                                        return 3000;
                                    }else if(f.INVENTION=="electric motor"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="engine with internal combustion"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="telephone"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="light bulb"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="motorcycle"){
                                        return 3000;
                                    }else if(f.INVENTION=="automobile"){
                                        return 3000;
                                    }
                                    else if(f.INVENTION=="X-ray imaging"){
                                        return 3000;
                                    }else if(f.INVENTION=="engine-powered airplane"){
                                        return 3000;
                                    }else if(f.INVENTION=="rocket engine"){
                                        return 3000;
                                    }else if(f.INVENTION=="television"){
                                        return 3000;
                                    }else if(f.INVENTION=="helicopter"){
                                        return 3000;
                                    }else if(f.INVENTION=="nuclear reactor"){
                                        return 3000;
                                    }else if(f.INVENTION=="atomic bomb"){
                                        return 3000;
                                    }else if(f.INVENTION=="transistor"){
                                        return 3000;
                                    }else if(f.INVENTION=="hard disk drive"){
                                        return 3000;
                                    }else if(f.INVENTION=="personal computer (IBM 610)"){
                                        return 3000;
                                    }else if(f.INVENTION=="Internet"){
                                        return 3000;
                                    }else if(f.INVENTION=="C (programming language)"){
                                        return 3000;
                                    }else if(f.INVENTION=="USB flash drive"){
                                        return 3000;
                                    }else{
                                        return 50;
                                    }
                                })
                                .delay(function(){
                                    if(f.INVENTION=="steamboat"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="Braille system"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="revolver"){
                                         return delayAdd1+=3000;
                                    }
                                    else if(f.INVENTION=="oil well"){
                                        return delayAdd1+=3000;
                                    }
                                    else if(f.INVENTION=="phonograph"){
                                        return delayAdd1+=3000;
                                    }
                                    else if(f.INVENTION=="saccharin"){
                                         return delayAdd1+=3000;
                                    }
                                     else if(f.INVENTION=="dishwasher"){
                                       return delayAdd1+=3000;
                                    }else if(f.INVENTION=="jukebox"){
                                       return delayAdd1+=3000;
                                    }
                                    else if(f.INVENTION=="radio"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="electrocardiogram (ECG, EKG)"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="baby food (prepared)"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="audiotape"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="lawn mower (gasoline-powered)"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="scuba gear"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="microwave oven"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="holography"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="Play-Doh"){
                                        return delayAdd1+=3000;
                                    }else if(f.INVENTION=="electric desktop calculator (Model 14-A)"){
                                         return delayAdd1+=3000;
                                    }else if(f.INVENTION=="videocassette recorder"){
                                       return delayAdd1+=3000;
                                    }else if(f.INVENTION=="static induction thyristor"){
                                         return delayAdd1+=3000;
                                    }else{
                                        return delayAdd1+=50;
                                    }
                                })
                                .ease("linear")
                                .style("visibility","visible")
                                .attr("x",scale(f.YEAR)-2)
                                .attr("y",function(){
                                    if (x==0) {
                                        x++;
                                        return y=20;
                                    }
                                    else if(inventions[x].YEAR!=inventions[x-1].YEAR){
                                        y=20;
                                    }
                                    else y+=17;
                                    x++;
                                    return y;});
                            })
                            .on("mouseover",function(f,k){
                                    var xPosition = parseFloat(d3.event.pageX+15) ;
                                    var yPosition = parseFloat(d3.event.pageY+15) ;
                                    if(f.YEAR>=1975){
                                         d3.select("#info").classed("hidden",false)
                                                    .style("left", (xPosition-200) + "px")
                                                    .style("top", (yPosition) + "px")
                                                    .html("In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY);
                                    }else{
                                         d3.select("#info").classed("hidden",false)
                                                    .style("left", xPosition + "px")
                                                    .style("top", yPosition + "px")
                                                    .html("In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY);
                                    }
                                })
                                .on("mousemove",function(f,k){
                                        var xPosition = parseFloat(d3.event.pageX+15) ;
                                        var yPosition = parseFloat(d3.event.pageY+15) ;
                                        if(f.YEAR>=1975){
                                         d3.select("#info").classed("hidden",false)
                                                    .style("left", (xPosition-200) + "px")
                                                    .style("top", (yPosition) + "px")
                                                    .html("In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY);
                                    }else{
                                         d3.select("#info").classed("hidden",false)
                                                    .style("left", xPosition + "px")
                                                    .style("top", yPosition + "px")
                                                    .html("In <b>"+f.YEAR+". "+f.INVENTOR+"</b> invented <b>" + f.INVENTION+"</b><br>Country: <b>"+f.COUNTRY);
                                    }
                                            
                                        d3.select("#info").classed("hidden",false);
                                })
                                .on("mouseleave",function(f,k){
                                    d3.select("#info").classed("hidden",true);
                                });

                                d3.select(this)
                                    .append("line")
                                    .attr("id",function(f,k){
                                       return f.id;
                                     })
                                    .each(function(){
                                        d3.select(this)
                                            .attr("x1", function(){
                                              var item = d3.select("path#"+f.id)
                                              var centroid = path.centroid(item.datum());
                                              if(f.id=="USA"){
                                                  return centroid[0]+30;
                                              }
                                              return centroid[0];
                                            })
                                            .attr("y1", function(){
                                              var item = d3.select("path#"+f.id);
                                              var centroid = path.centroid(item.datum());
                                              if(f.id=="USA"){
                                                  return centroid[1]+80;
                                              }
                                              return centroid[1]+50;
                                            })
                                            .attr("x2", scale(f.YEAR)+5)
                                            .attr("y2", function(){
                                             if (x1==0) {
                                                x1++;
                                                return y1=22;
                                            }
                                            else if(inventions[x1].YEAR!=inventions[x1-1].YEAR){
                                                y1=20;
                                            }
                                            else y1+=17;
                                            x1++;
                                            return y1;})
                                            .style("stroke","white")
                                            .style("stroke-width","1px")
                                            .attr("stroke-dasharray", d3.select(this).node().getTotalLength() + " " + d3.select(this).node().getTotalLength())
                                            .attr("stroke-dashoffset", d3.select(this).node().getTotalLength())
                                            .transition()
                                            .duration(function(){
                                                if(f.INVENTION=="battery"){
                                                    return 3000;
                                                }else if(f.INVENTION=="Programmable mechanical computer"){
                                                    return 3000;
                                                }else if(f.INVENTION=="electric motor"){
                                                    return 3000;
                                                }
                                                else if(f.INVENTION=="engine with internal combustion"){
                                                    return 3000;
                                                }
                                                else if(f.INVENTION=="telephone"){
                                                    return 3000;
                                                }
                                                else if(f.INVENTION=="light bulb"){
                                                    return 3000;
                                                }
                                                else if(f.INVENTION=="motorcycle"){
                                                    return 3000;
                                                }else if(f.INVENTION=="automobile"){
                                                    return 3000;
                                                }
                                                else if(f.INVENTION=="X-ray imaging"){
                                                    return 3000;
                                                }else if(f.INVENTION=="engine-powered airplane"){
                                                    return 3000;
                                                }else if(f.INVENTION=="rocket engine"){
                                                    return 3000;
                                                }else if(f.INVENTION=="television"){
                                                    return 3000;
                                                }else if(f.INVENTION=="helicopter"){
                                                    return 3000;
                                                }else if(f.INVENTION=="nuclear reactor"){
                                                    return 3000;
                                                }else if(f.INVENTION=="atomic bomb"){
                                                    return 3000;
                                                }else if(f.INVENTION=="transistor"){
                                                    return 3000;
                                                }else if(f.INVENTION=="hard disk drive"){
                                                    return 3000;
                                                }else if(f.INVENTION=="personal computer (IBM 610)"){
                                                    return 3000;
                                                }else if(f.INVENTION=="Internet"){
                                                    return 3000;
                                                }else if(f.INVENTION=="C (programming language)"){
                                                    return 3000;
                                                }else if(f.INVENTION=="USB flash drive"){
                                                    return 3000;
                                                }else{
                                                    return 50;
                                                }
                                            })
                                            .delay(function(){
                                                if(f.INVENTION=="steamboat"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="Braille system"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="revolver"){
                                                    return delayAdd2+=3000;
                                                }
                                                else if(f.INVENTION=="oil well"){
                                                    return delayAdd2+=3000;
                                                }
                                                else if(f.INVENTION=="phonograph"){
                                                    return delayAdd2+=3000;
                                                }
                                                else if(f.INVENTION=="saccharin"){
                                                    return delayAdd2+=3000;
                                                }
                                                 else if(f.INVENTION=="dishwasher"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="jukebox"){
                                                    return delayAdd2+=3000;
                                                }
                                                else if(f.INVENTION=="radio"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="electrocardiogram (ECG, EKG)"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="baby food (prepared)"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="audiotape"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="lawn mower (gasoline-powered)"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="scuba gear"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="microwave oven"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="holography"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="Play-Doh"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="electric desktop calculator (Model 14-A)"){
                                                    return delayAdd2+=3000;
                                                }else if(f.INVENTION=="videocassette recorder"){
                                                return delayAdd2+=3000;
                                                }else if(f.INVENTION=="static induction thyristor"){
                                                    return delayAdd2+=3000;
                                                }else{
                                                    return delayAdd2+=50;
                                                }
                                            })
                                            .ease("linear") 
                                            .attr("stroke-dashoffset", 0)
                                            .transition()
                                            .duration(1000)
                                            .delay(function(){
                                                 if(f.INVENTION=="battery"){
                                                    return delayAdd3+=3500;
                                                }else if(f.INVENTION=="Programmable mechanical computer"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="electric motor"){
                                                    return delayAdd3+=3000;
                                                }
                                                else if(f.INVENTION=="engine with internal combustion"){
                                                    return delayAdd3+=3000;
                                                }
                                                else if(f.INVENTION=="telephone"){
                                                    return delayAdd3+=3000;
                                                }
                                                else if(f.INVENTION=="light bulb"){
                                                    return delayAdd3+=3000;
                                                }
                                                else if(f.INVENTION=="motorcycle"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="automobile"){
                                                    return delayAdd3+=3000;
                                                }
                                                else if(f.INVENTION=="X-ray imaging"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="engine-powered airplane"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="rocket engine"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="television"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="helicopter"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="nuclear reactor"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="atomic bomb"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="transistor"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="hard disk drive"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="personal computer (IBM 610)"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="Internet"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="C (programming language)"){
                                                    return delayAdd3+=3000;
                                                }else if(f.INVENTION=="USB flash drive"){
                                                    return delayAdd3+=3000;
                                                }else{
                                                    return delayAdd3+=70;
                                                }
                                            })
                                            .style("visibility","hidden");
                                    })
                                
                        })
    })
});

    function showInventions(x) {
        svg.selectAll("image")
            .each(function(d,i){
                var lightbulb=d3.select(this);
                if(inventions[i].COUNTRY==x.properties.name || clickedName==inventions[i].COUNTRY){
                      lightbulb.attr("href","lightbulb_on.png")
                      .attr("class","on");
                }
                else  {
                    lightbulb.attr("href","lightbulb_off2.png")
                            .attr("class","off");
                }
            })
    }

});

    
</script>

</html>